{"version":3,"sources":["../../../../../OOAD%20Project/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","../../../../../OOAD%20Project/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client.ts","../../../../../OOAD%20Project/app/student/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactServerDOMTurbopackClient\n"," 'use client';\n\nimport { useEffect, useState } from 'react';\nimport supabase from '@/lib/supabaseClient';\nimport { useRouter } from 'next/navigation';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport Link from 'next/link';\n\ninterface Assignment {\n  id: string;\n  title: string;\n  description: string;\n  due_date: string;\n  max_points: number;\n}\n\ninterface Quiz {\n  id: string;\n  title: string;\n  due_date: string;\n  time_limit_minutes: number;\n}\n\nexport default function StudentDashboard() {\n  const router = useRouter();\n  const [user, setUser] = useState<any>(null);\n  const [assignments, setAssignments] = useState<Assignment[]>([]);\n  const [quizzes, setQuizzes] = useState<Quiz[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    const loadData = async () => {\n      try {\n        const meResponse = await fetch('/api/me', { credentials: 'include' });\n        if (!meResponse.ok) {\n          // Try a client-side Supabase session fallback before redirecting\n          const { data: sessionData, error: sessionError } = await supabase.auth.getSession();\n          if (sessionError || !sessionData?.session) {\n            router.push('/login');\n            return;\n          }\n\n          const user = sessionData.session.user;\n          const role = (user.user_metadata as any)?.role || 'student';\n          if (role !== 'student') {\n            router.push('/login');\n            return;\n          }\n\n          // attempt to sync the session to server (best-effort)\n          try {\n            await fetch('/api/auth/sync', {\n              method: 'POST',\n              credentials: 'include',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ access_token: (sessionData as any).session.access_token }),\n            });\n          } catch (syncErr) {\n            console.error('session sync error:', syncErr);\n          }\n\n          setUser({ id: user.id, name: (user.user_metadata as any)?.name || '', email: user.email, role });\n        } else {\n          const meData = await meResponse.json();\n          if (meData.data.role !== 'student') {\n            router.push('/login');\n            return;\n          }\n          setUser(meData.data);\n        }\n\n        const [assignmentsRes, quizzesRes] = await Promise.all([\n          fetch('/api/assignments', { credentials: 'include' }),\n          fetch('/api/quizzes', { credentials: 'include' }),\n        ]);\n\n        if (assignmentsRes.ok) {\n          const assignmentsData = await assignmentsRes.json();\n          setAssignments(assignmentsData.data);\n        }\n\n        if (quizzesRes.ok) {\n          const quizzesData = await quizzesRes.json();\n          setQuizzes(quizzesData.data);\n        }\n      } catch (error) {\n        console.error('Error loading data:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    loadData();\n  }, [router]);\n\n  const handleLogout = async () => {\n  await fetch('/api/auth/logout', { method: 'POST', credentials: 'include' });\n    router.push('/');\n  };\n\n  if (isLoading) return <div className=\"p-4\">Loading...</div>;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b\">\n        <div className=\"container mx-auto px-4 py-4 flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-2xl font-bold\">Student Dashboard</h1>\n            <p className=\"text-sm text-muted-foreground\">Welcome, {user?.name}</p>\n          </div>\n          <Button variant=\"outline\" onClick={handleLogout}>\n            Logout\n          </Button>\n        </div>\n      </header>\n\n      <main className=\"container mx-auto px-4 py-8\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n          <div>\n            <h2 className=\"text-xl font-semibold mb-4\">Assignments</h2>\n            <div className=\"space-y-4\">\n              {assignments.length === 0 ? (\n                <p className=\"text-muted-foreground\">No assignments yet</p>\n              ) : (\n                assignments.map((assignment) => (\n                  <Card key={assignment.id}>\n                    <CardHeader>\n                      <CardTitle className=\"text-lg\">{assignment.title}</CardTitle>\n                      <CardDescription>\n                        Due: {new Date(assignment.due_date).toLocaleDateString()}\n                      </CardDescription>\n                    </CardHeader>\n                    <CardContent>\n                      <p className=\"text-sm mb-4\">{assignment.description}</p>\n                      <Link href={`/student/assignment/${assignment.id}`}>\n                        <Button size=\"sm\">View & Submit</Button>\n                      </Link>\n                    </CardContent>\n                  </Card>\n                ))\n              )}\n            </div>\n          </div>\n\n          <div>\n            <h2 className=\"text-xl font-semibold mb-4\">Quizzes</h2>\n            <div className=\"space-y-4\">\n              {quizzes.length === 0 ? (\n                <p className=\"text-muted-foreground\">No quizzes yet</p>\n              ) : (\n                quizzes.map((quiz) => (\n                  <Card key={quiz.id}>\n                    <CardHeader>\n                      <CardTitle className=\"text-lg\">{quiz.title}</CardTitle>\n                      <CardDescription>\n                        Due: {new Date(quiz.due_date).toLocaleDateString()}\n                      </CardDescription>\n                    </CardHeader>\n                    <CardContent>\n                      <p className=\"text-sm mb-4\">Time limit: {quiz.time_limit_minutes} minutes</p>\n                      <Link href={`/student/quiz/${quiz.id}`}>\n                        <Button size=\"sm\">Take Quiz</Button>\n                      </Link>\n                    </CardContent>\n                  </Card>\n                ))\n              )}\n            </div>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n"],"names":["module","exports","require","vendored","ReactJsxRuntime","ReactServerDOMTurbopackClient"],"mappings":"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","ignoreList":[0,1]}