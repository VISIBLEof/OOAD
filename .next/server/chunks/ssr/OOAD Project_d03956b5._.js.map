{"version":3,"sources":["../../../../../OOAD%20Project/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","../../../../../OOAD%20Project/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client.ts","../../../../../OOAD%20Project/components/ui/input.tsx","../../../../../OOAD%20Project/app/login/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactServerDOMTurbopackClient\n","import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Input({ className, type, ...props }: React.ComponentProps<'input'>) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n        'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\n        'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n"," 'use client';\n\nimport { useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport supabase from '@/lib/supabaseClient';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport Link from 'next/link';\n\nexport default function LoginPage() {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState('');\n  const router = useRouter();\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    setIsLoading(true);\n    setError('');\n\n    try {\n      const { data, error } = await supabase.auth.signInWithPassword({ email, password });\n      if (error) {\n        setError(error.message || 'Login failed');\n        return;\n      }\n\n      // If Supabase returned a session, sync it to our server so server-side pages see the auth cookie\n      const accessToken = (data as any)?.session?.access_token;\n      if (accessToken) {\n        const res = await fetch('/api/auth/sync', {\n          method: 'POST',\n          credentials: 'include',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ access_token: accessToken }),\n        });\n        if (!res.ok) {\n          const j = await res.json().catch(() => ({}));\n          setError(j.error || 'Failed to sync session');\n          return;\n        }\n      }\n\n      const role = (data.user?.user_metadata as any)?.role || 'student';\n      router.push(role === 'admin' ? '/admin' : role === 'teacher' ? '/teacher' : '/student');\n    } catch (error) {\n      const msg = (error as any)?.message || 'An error occurred';\n      setError(msg);\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  async function handleSendMagicLink() {\n    if (!email) return setError('Enter your email to receive a sign-in link');\n    setIsLoading(true);\n    setError('');\n    try {\n      const { error } = await supabase.auth.signInWithOtp({ email });\n      if (error) {\n        setError(error.message || 'Could not send sign-in link');\n        return;\n      }\n      setError('Magic sign-in link sent — check your email');\n    } catch (err) {\n      setError('Could not send sign-in link');\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-muted p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader>\n          <CardTitle>Login</CardTitle>\n          <CardDescription>Access your student assignment account</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {error && <div className=\"p-3 bg-destructive/10 text-destructive text-sm rounded\">{error}</div>}\n            \n            <div>\n              <label className=\"text-sm font-medium\">Email</label>\n              <Input\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                required\n                disabled={isLoading}\n                placeholder=\"you@example.com\"\n              />\n            </div>\n\n            <div>\n              <label className=\"text-sm font-medium\">Password</label>\n              <Input\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                required\n                disabled={isLoading}\n                placeholder=\"••••••••\"\n              />\n            </div>\n\n            <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\n              {isLoading ? 'Loading...' : 'Login'}\n            </Button>\n            {/* Show magic link action when error indicates confirmation required */}\n            {error?.toLowerCase().includes('confirm') && (\n              <div className=\"mt-2\">\n                <button type=\"button\" className=\"w-full bg-secondary text-white py-2 rounded\" onClick={handleSendMagicLink} disabled={isLoading}>\n                  {isLoading ? 'Sending...' : 'Send sign-in link'}\n                </button>\n              </div>\n            )}\n          </form>\n\n          <div className=\"mt-4 text-center text-sm\">\n            Don't have an account?{' '}\n            <Link href=\"/register\" className=\"text-primary hover:underline\">\n              Register here\n            </Link>\n          </div>\n\n          <div className=\"mt-6 pt-6 border-t space-y-2 text-xs text-muted-foreground\">\n            <p>Demo credentials:</p>\n            <p>Student: student@example.com / Student123!</p>\n            <p>Teacher: teacher@example.com / Teacher123!</p>\n            <p>Admin: admin@example.com / Admin123!</p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":["module","exports","require","vendored","ReactJsxRuntime","ReactServerDOMTurbopackClient"],"mappings":"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","ignoreList":[0,1]}